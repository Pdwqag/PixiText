{% extends "base.html" %}
{% block content %}
<section class="panel gallery-panel">
  <header class="panel-heading">
    <div class="panel-heading__text">
      <span class="panel-kicker">Gallery</span>
      <h2 class="panel-title">アップロード一覧</h2>
      <p class="panel-description">生成されたショートコードは本文からいつでも呼び出せます。不要になったファイルはここで整理しましょう。</p>
    </div>
    <div class="panel-actions">
      <a href="{{ url_for('index') }}" class="link-button subtle">← エディタへ戻る</a>
    </div>
  </header>

  {% if items %}
    <div class="mg-grid mg-grid-lg">
      {% for it in items %}
        <div class="mg-card">
          <a class="mg-thumb" href="{{ url_for('image_by_id', img_id=it.id) }}" target="_blank" rel="noopener">
            <img src="{{ url_for('image_by_id', img_id=it.id) }}"
                 alt="{{ it.original_name or it.stored_name }}">
          </a>
          <div class="mg-body">
            <div class="mg-name" title="{{ it.original_name or it.stored_name }}">{{ it.original_name or it.stored_name }}</div>
            <div class="mg-actions">
              <input class="mg-code" type="text" readonly value="[uploadedimage:{{ it.id }}]">
              <button class="mg-btn copy" type="button" data-copy="[uploadedimage:{{ it.id }}]">コピー</button>
              <form method="post"
                    action="{{ url_for('delete_image', img_id=it.id, next='index') }}"
                    class="js-delete" data-id="{{ it.id }}">
                <button class="mg-btn delete" type="submit">削除</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="empty-hint">まだ画像がありません。エディタからアップロードしてください。</p>
  {% endif %}

  <div class="panel-divider"></div>
  <section class="cloud-note cloud-note--accent" aria-label="Sync.com 連携ガイド">
    <p><strong>Sync.com で画像を管理するには</strong></p>
    <ol>
      <li><a href="https://cp.sync.com/files" target="_blank" rel="noopener">cp.sync.com/files</a> にサインインし、<code>uploads</code> フォルダを作成して共有リンクを取得します。</li>
      <li>ここでダウンロードした画像ファイルをそのフォルダへアップロードし、バックアップを最新状態に保ちます。</li>
      <li>（任意）<a href="{{ url_for('sync_manifest_export') }}">ローカルからマニフェストを生成</a>して Sync.com にアップロードすると、クラウド側でもファイル一覧を確認しやすくなります。</li>
    </ol>
  </section>
</section>
{% endblock %}
